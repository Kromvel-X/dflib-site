<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<meta name="author" content="Andrus Adamchik and other contributors">
<title>DFLib Documentation</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/*! Stylesheet for CodeRay to loosely match GitHub themes | MIT License */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid;opacity:.35;padding:0 .5em 0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff!important;background:navy!important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:navy}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:teal}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:teal}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:teal}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword{color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:teal}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>DFLib Documentation</h1>
<div class="details">
<span id="author" class="author">Andrus Adamchik and other contributors</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_getting_started_with_dflib">Getting Started with DFLib</a></li>
<li><a href="#_main_data_structures">Main Data Structures</a>
<ul class="sectlevel2">
<li><a href="#_series">Series</a></li>
<li><a href="#_dataframe">DataFrame</a></li>
<li><a href="#index">Index</a></li>
</ul>
</li>
<li><a href="#printers">Printers</a></li>
<li><a href="#expressions">Expressions</a>
<ul class="sectlevel2">
<li><a href="#_column_expressions">Column Expressions</a></li>
<li><a href="#_complex_expressions">Complex Expressions</a></li>
<li><a href="#_numeric_expressions">Numeric Expressions</a></li>
<li><a href="#_date_expressions">Date Expressions</a></li>
<li><a href="#_conditions">Conditions</a></li>
<li><a href="#sorter">Sorters</a></li>
</ul>
</li>
<li><a href="#selecting">Selecting Rows and Columns</a>
<ul class="sectlevel2">
<li><a href="#_selecting_columns">Selecting Columns</a></li>
<li><a href="#_deleting_columns">Deleting Columns</a></li>
<li><a href="#_selecting_rows_by_position">Selecting Rows by Position</a></li>
<li><a href="#_selecting_rows_by_condition">Selecting Rows by Condition</a></li>
<li><a href="#_head_and_tail">Head and Tail</a></li>
</ul>
</li>
<li><a href="#column-manipulation">Columns Manipulation</a>
<ul class="sectlevel2">
<li><a href="#adding-columns">Adding Columns</a></li>
<li><a href="#_renaming_columns">Renaming Columns</a></li>
<li><a href="#transforming-columns">Transforming Columns</a></li>
</ul>
</li>
<li><a href="#_cleaning_up_data">Cleaning up Data</a>
<ul class="sectlevel2">
<li><a href="#_filling_nulls_in_series">Filling Nulls in Series</a></li>
<li><a href="#_filling_nulls_in_dataframe">Filling Nulls in DataFrame</a></li>
</ul>
</li>
<li><a href="#sort">Sorting</a>
<ul class="sectlevel2">
<li><a href="#_sorting_series">Sorting Series</a></li>
<li><a href="#_sorting_dataframe">Sorting DataFrame</a></li>
</ul>
</li>
<li><a href="#_concatenating">Concatenating</a>
<ul class="sectlevel2">
<li><a href="#_concatenating_series">Concatenating Series</a></li>
<li><a href="#_concatenating_dataframes">Concatenating DataFrames</a></li>
</ul>
</li>
<li><a href="#joins">Joins</a>
<ul class="sectlevel2">
<li><a href="#_inner_join">Inner Join</a></li>
<li><a href="#_outer_joins">Outer Joins</a></li>
<li><a href="#_indicator_column">Indicator Column</a></li>
<li><a href="#_nested_loop_joins">Nested Loop Joins</a></li>
</ul>
</li>
<li><a href="#grouping">Grouping and Aggregating</a></li>
<li><a href="#window">Window functions</a></li>
<li><a href="#pivot">Pivot</a></li>
<li><a href="#stack">Stack</a></li>
<li><a href="#jdbc">Working with Relational Databases</a>
<ul class="sectlevel2">
<li><a href="#_jdbcconnector">JdbcConnector</a></li>
<li><a href="#_tableloader_tablesaver">TableLoader / TableSaver</a></li>
<li><a href="#_sqlloader_sqlsaver">SqlLoader / SqlSaver</a></li>
</ul>
</li>
<li><a href="#csv">Working with .csv Files</a>
<ul class="sectlevel2">
<li><a href="#_reading_dataframe_from_csv">Reading DataFrame from CSV</a></li>
<li><a href="#_writing_dataframe_to_a_csv">Writing DataFrame to a CSV</a></li>
</ul>
</li>
<li><a href="#excel">Working with Excel Files</a></li>
<li><a href="#avro">Working with .avro Files</a>
<ul class="sectlevel2">
<li><a href="#_avro_schema">Avro Schema</a></li>
</ul>
</li>
<li><a href="#jupyter">Working in Jupyter Notebook</a>
<ul class="sectlevel2">
<li><a href="#_installing_jupyter_with_java_kernel">Installing Jupyter with Java Kernel</a></li>
<li><a href="#_work_with_dflib_in_jupyter">Work with DFLib in Jupyter</a></li>
<li><a href="#_change_display_parameters">Change Display Parameters</a></li>
<li><a href="#_notebooks_and_version_control">Notebooks and Version Control</a></li>
</ul>
</li>
<li><a href="#unit-testing">Unit Testing</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>"DFLib" (short for "DataFrame Library") is a lightweight, pure Java implementation of <code>DataFrame</code>. <code>DataFrame</code> is a
very common structure in data science and Big Data worlds. It provides operations like search,
filtering, joins, aggregations, statistical functions, etc., that are reminiscent of SQL (also of Excel), except you run
them in your app over dynamic in-memory data sets.</p>
</div>
<div class="paragraph">
<p>There are <code>DataFrame</code> implementations in Python (<a href="https://pandas.pydata.org/">pandas</a>), R,
<a href="https://spark.apache.org/docs/latest/sql-programming-guide.html#datasets-and-dataframes">Apache Spark</a>, etc.
DFLib project&#8217;s goal is to provide the same functionality for regular Java applications. It is a simple library, that
requires no special infrastructure. DFLib core is dependency-free.</p>
</div>
<div class="paragraph">
<p>The code in this documentation can be run in any Java IDE, as well as (and this is pretty cool!) in a <a href="#jupyter">Jupyter notebook</a>. You will need Java 11 or newer.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started_with_dflib">Getting Started with DFLib</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Include DFLib in a project. Assuming you are using Maven, start by declaring a "BOM" to have a common version for
multiple DFLib modules:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependencyManagement&gt;</span>
  <span class="tag">&lt;dependencies&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
      <span class="tag">&lt;groupId&gt;</span>com.nhl.dflib<span class="tag">&lt;/groupId&gt;</span>
      <span class="tag">&lt;artifactId&gt;</span>dflib-bom<span class="tag">&lt;/artifactId&gt;</span>
      <span class="tag">&lt;version&gt;</span>0.18<span class="tag">&lt;/version&gt;</span>
      <span class="tag">&lt;type&gt;</span>pom<span class="tag">&lt;/type&gt;</span>
      <span class="tag">&lt;scope&gt;</span>import<span class="tag">&lt;/scope&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
  <span class="tag">&lt;/dependencies&gt;</span>
<span class="tag">&lt;/dependencyManagement&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Next include DFLib core as a dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>com.nhl.dflib<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>dflib<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a DataFrame, do some manipulations with it, print the result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df1 = DataFrame
        .foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">b</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">c</span><span class="delimiter">&quot;</span></span>)
        .ofStream(IntStream.range(<span class="integer">1</span>, <span class="integer">10000</span>));

DataFrame df2 = df1.selectRows(
        df1.getColumn(<span class="integer">0</span>).castAsInt().indexInt(i -&gt; i % <span class="integer">2</span> == <span class="integer">0</span>));

<span class="predefined-type">System</span>.out.println(Printers.tabular.toString(df2));</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you run this code, console output will look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>   a    b    c
---- ---- ----
   4    5    6
  10   11   12
  16   17   18
...
9982 9983 9984
9988 9989 9990
9994 9995 9996
1666 rows x 3 columns</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We&#8217;ll omit print statements in all the following examples, and will simply display their output. Details of
printing are discussed in the in <a href="#printers">"Printers" chapter</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_main_data_structures">Main Data Structures</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The two essential DFLib classes are <code>Series</code> and <code>DataFrame</code>. <code>Series</code> is a 1-dimensional array-like object, and <code>DataFrame</code>
is a 2-dimensional table-like object. Columns in a DataFrame are stored as Series. Additionally, we will discuss
<code>Index</code> object that stores DataFrame column names.</p>
</div>
<div class="paragraph">
<p>Both DataFrame and Series (and Index) are fully <em>immutable</em>, so all operations on them return a new instance. Behind
the scenes the library shares as much data as possible between instances, so copying these objects does not cause
significant performance degradation, and in turn makes DFLib fully thread-safe, with multiple concurrent operations
possible on the same data structure. Also, immutability means that you can have full snapshots of your data at each
step of a transformation, simplifying debugging and auditing of data pipelines.</p>
</div>
<div class="sect2">
<h3 id="_series">Series</h3>
<div class="paragraph">
<p><code>Series</code> is the simplest of the two data structures. You can think of it as a wrapper around an array of values.
You can use <code>Series</code> to model sequences of data such as timestamps in a time series. Series object is parameterized for
the type of data that it holds. So there can be <code>Series&lt;String&gt;</code> or a <code>Series&lt;LocalDate&gt;</code>, etc. There is also an
important category of "primitive" Series (<code>IntSeries</code>, <code>LongSeries</code>, <code>DoubleSeries</code>, <code>BooleanSeries</code>) that are optimized
for memory use and arithmetic operations. Of course, each primitive Series can also pose as Series of a corresponding
wrapper object type (e.g. <code>IntSeries</code> is also a <code>Series&lt;Integer&gt;</code>).</p>
</div>
<div class="paragraph">
<p><code>Series</code> object is an important building block of DataFrame, but it defines a number of useful data
manipulation and transformation operations on its own. Those will be covered in the following chapters. Here we&#8217;ll
discuss how to create Series.</p>
</div>
<div class="sect3">
<h4 id="_creating_series_from_arrays">Creating Series from Arrays</h4>
<div class="paragraph">
<p><code>Series</code> can be created using static <code>ofXyz(..)</code> methods on the <code>Series</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Series&lt;<span class="predefined-type">String</span>&gt; s = Series.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">bcd</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">ef</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">g</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>a
bcd
...
g
4 elements</pre>
</div>
</div>
<div class="paragraph">
<p>Primitive Series classes have their own factory methods. E.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">IntSeries is = Series.ofInt(<span class="integer">0</span>, <span class="integer">1</span>, -<span class="integer">300</span>, <span class="predefined-type">Integer</span>.MAX_VALUE);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_creating_series_by_element">Creating Series By Element</h4>
<div class="paragraph">
<p>If we don&#8217;t have a data array or collection to start with, and instead somehow produce a sequence of
values of unpredictable length, we can use <code>Series.byElement()</code> API. E.g. the following example reads data from
an InputStream line by line as Strings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// InputStream inputStream = ...</span>
SeriesAppender&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; appender = Series
        .byElement(Extractor.&lt;<span class="predefined-type">String</span>&gt;<span class="error">$</span>col()) <i class="conum" data-value="1"></i><b>(1)</b>
        .appender();

<span class="predefined-type">Scanner</span> scanner = <span class="keyword">new</span> <span class="predefined-type">Scanner</span>(inputStream);
<span class="keyword">while</span> (scanner.hasNext()) {
    appender.append(scanner.next()); <i class="conum" data-value="2"></i><b>(2)</b>
}

Series&lt;<span class="predefined-type">String</span>&gt; s = appender.toSeries();</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create Series "appender" that will accumulate values. For primitive Series you would use <code>Extractor.$int(..)</code>,
<code>Extractor.$long(..)</code> and so on</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Append values as they are read one-by-one</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dataframe">DataFrame</h3>
<div class="paragraph">
<p><code>DataFrame</code> is an in-memory table with rows and columns. Each column has a name, and is represented as a <code>Series</code> object.
DataFrame can contain columns of different kinds and is not parameterized for a single type.</p>
</div>
<div class="paragraph">
<p>There are a few ways to create a DataFrame. Here we&#8217;ll show "builder" API to convert arrays, Streams, Collections,
Series and other in-memory data into DataFrames.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
More often than not, a DataFrame is not created manually and is instead loaded from (and saved to) an external
source, like a <a href="#jdbc">database</a> or a <a href="#csv">CSV file</a>. Those are discussed in separate documentation chapters.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>First example - adding data row by row:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame
        .byArrayRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>
        .appender() <i class="conum" data-value="2"></i><b>(2)</b>
        .append(<span class="string"><span class="delimiter">&quot;</span><span class="content">Joe</span><span class="delimiter">&quot;</span></span>, <span class="integer">18</span>)   <i class="conum" data-value="3"></i><b>(3)</b>
        .append(<span class="string"><span class="delimiter">&quot;</span><span class="content">Andrus</span><span class="delimiter">&quot;</span></span>, <span class="integer">49</span>)
        .append(<span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="integer">32</span>)
        .toDataFrame();</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A special builder is created to append each row as a vararg array</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The builder creates an "appender" object. While here we are using the builder with default settings, it has extra
methods to configure capacity, data sampling, etc.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Passing individual rows to the appender one-by-one</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The resulting DataFrame looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>name   age
------ ---
Joe    18
Andrus 49
Joan   32
3 rows x 2 columns</pre>
</div>
</div>
<div class="paragraph">
<p>A more general example - creating a DataFrame from a list of objects by "extracting" column data from object properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>        record Person(String name, int age) {
        }

        List&lt;Person&gt; people = List.of(
                new Person("Joe", 18),
                new Person("Andrus", 49),
                new Person("Joan", 32));

        DataFrame df = DataFrame
                .byRow( <i class="conum" data-value="1"></i><b>(1)</b>
                        Extractor.$col(Person::name),
                        Extractor.$int(Person::age))
                .columnNames("name", "age") <i class="conum" data-value="2"></i><b>(2)</b>
                .appender() <i class="conum" data-value="3"></i><b>(3)</b>
                .append(people)   <i class="conum" data-value="4"></i><b>(4)</b>
                .toDataFrame();</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The builder is started with an array of Extractors. Each extractor generates its own column, filling it with a
corresponding object property.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Specifying the names of the DataFrame columns. If omitted, column names are assigned automatically.
in step 1.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Creating a row-by-row appender</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Appending the list.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The resulting DataFrame looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>name   age
------ ---
Joe    18
Andrus 49
Joan   32
3 rows x 2 columns</pre>
</div>
</div>
<div class="paragraph">
<p>Another example - a single-dimensional array can be "folded" into a DataFrame row-by-row:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame
        .foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>
        .of(<span class="string"><span class="delimiter">&quot;</span><span class="content">Joe</span><span class="delimiter">&quot;</span></span>, <span class="integer">18</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Andrus</span><span class="delimiter">&quot;</span></span>, <span class="integer">49</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="integer">32</span>); <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Folding Builder is created</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Passing a varargs array of values, that is folded to match the specified number of columns, row by row.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Same, but folding column-by-column:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame
        .foldByColumn(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span>)
        .of(<span class="string"><span class="delimiter">&quot;</span><span class="content">Joe</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Andrus</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="integer">18</span>, <span class="integer">49</span>, <span class="integer">32</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also create DataFrames from collections or Streams (folded either by row or by column). Here is an example
of how to use a Stream of primitive ints, creating a DataFrame made of memory-efficient <code>IntSeries</code> columns:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame
        .foldByColumn(<span class="string"><span class="delimiter">&quot;</span><span class="content">col1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">col2</span><span class="delimiter">&quot;</span></span>)
        .ofStream(IntStream.range(<span class="integer">0</span>, <span class="integer">10000</span>));</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>col1 col2
---- ----
   0 5000
   1 5001
   2 5002
...
4997 9997
4998 9998
4999 9999
5000 rows x 2 columns</pre>
</div>
</div>
<div class="paragraph">
<p>Finally, a DataFrame can be created from an array of Series, each Series representing a column:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame
        .byColumn(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span>)
        .of(
                Series.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">Joe</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Andrus</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>),
                Series.ofInt(<span class="integer">18</span>, <span class="integer">49</span>, <span class="integer">32</span>)
        );</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is the most efficient way, as an array of Series is how each DataFrame is structured internally.</p>
</div>
<div class="paragraph">
<p>Now that we&#8217;ve discussed how to create Series and DataFrames, we&#8217;ll talk about <a href="#printers">printing their contents</a>,
and then will continue to the chapters that describe data operations.</p>
</div>
</div>
<div class="sect2">
<h3 id="index">Index</h3>
<div class="paragraph">
<p><code>Index</code> is somewhat similar to Series. It stores a sequence of String labels, corresponding to column labels in a
DataFrame it is attached to. While you normally won&#8217;t need to create or manipulate Index outside a DataFrame, you
may use it to access DataFrame columns labels.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame
        .foldByColumn(<span class="string"><span class="delimiter">&quot;</span><span class="content">col1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">col2</span><span class="delimiter">&quot;</span></span>)
        .of(IntStream.range(<span class="integer">0</span>, <span class="integer">10000</span>));

<span class="predefined-type">String</span><span class="type">[]</span> labels = df.getColumnsIndex().getLabels(); <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Access DataFrame index and read label names.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="printers">Printers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When doing data exploration and running data pipelines, it is important to be able to visualize data at every step.
More advanced forms of visualization include charts and diagrams. But the simplest thing you can do is printing
data to the console. Both <code>DataFrame</code> and <code>Series</code> implement <code>toString()</code> method, that will print their contents
as a single line, truncating large data sets in the process, which is good for debugging applications running on a
server.</p>
</div>
<div class="paragraph">
<p>A more human-friendly form of output is done by using a <em>tabular</em> printer. Here is how to use the default tabular
printer:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame
        .foldByColumn(<span class="string"><span class="delimiter">&quot;</span><span class="content">col1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">col2</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">col3</span><span class="delimiter">&quot;</span></span>)
        .ofStream(IntStream.range(<span class="integer">0</span>, <span class="integer">10000</span>));

<span class="predefined-type">String</span> table = Printers.tabular.toString(df);
<span class="predefined-type">System</span>.out.println(table);</code></pre>
</div>
</div>
<div class="paragraph">
<p>It prints the data as follows, displaying at most 6 rows and truncating the rest. Same goes for cell values. Values
longer than 30 chars are also truncated (since they are pretty short in our example, value truncation is not obvious here).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>col1 col2 col3
---- ---- ----
   0 3334 6668
   1 3335 6669
   2 3336 6670
...
3331 6665 9999
3332 6666    0
3333 6667    0
3334 rows x 3 columns</pre>
</div>
</div>
<div class="paragraph">
<p>You can change the truncation parameters by creating your own printer:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Printer printer = <span class="keyword">new</span> TabularPrinter(<span class="integer">3</span>, <span class="integer">3</span>); <i class="conum" data-value="1"></i><b>(1)</b>
<span class="predefined-type">String</span> table = printer.toString(df);
<span class="predefined-type">System</span>.out.println(table);</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create a printer that displays at most 3 rows and up to 3 characters in each cell.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>c.. c.. c..
--- --- ---
  0 3.. 6..
  1 3.. 6..
...
3.. 6..   0
3334 rows x 3 columns</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are using <a href="#jupyter">Jupyter Notebook</a>, all the printers are already setup for you. So if the last
statement in a Jupyter cell is a <code>DataFrame</code> or a <code>Series</code>, it will be printed as a table in the notebook.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="expressions">Expressions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>DFLib includes a built-in expression language (implemented as a Java "DSL"). It allows to manipulate columns and rows
in DataFrames and data in Series. <code>Exp</code> is the interface representing an expression that takes a DataFrame or a
Series and produces a Series of the specified type. It also provides an entry point to create expressions via its static
factory methods.</p>
</div>
<div class="paragraph">
<p>To use expressions, you&#8217;d start by adding a static import of the <code>Exp</code> interface, so that all its factory methods
are available directly in the code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">static</span> <span class="include">com.nhl.dflib.Exp</span>.*;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now let&#8217;s create two simple expressions that return a named and a positional column of the requested type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">StrExp lastExp = <span class="error">$</span>str(<span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>);
DecimalExp salaryExp = <span class="error">$</span>decimal(<span class="integer">2</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>And now let&#8217;s evaluate the expressions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">salary</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Cosin</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> <span class="predefined-type">BigDecimal</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">120000</span><span class="delimiter">&quot;</span></span>),
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Juliana</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Walewski</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> <span class="predefined-type">BigDecimal</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">80000</span><span class="delimiter">&quot;</span></span>),
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">O'Hara</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> <span class="predefined-type">BigDecimal</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">95000</span><span class="delimiter">&quot;</span></span>));

Series&lt;<span class="predefined-type">String</span>&gt; last = lastExp.eval(df);
Series&lt;<span class="predefined-type">BigDecimal</span>&gt; salary = salaryExp.eval(df);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This doesn&#8217;t look like much (other DFLib APIs would do the same), but this basic abstraction allows to implement a
wide range of operations (filtering, sorting, aggregation, etc). The following chapters will demonstrate various use
cases for expressions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
DFLib expression language Expressions work on DFLib data structures instead of individual values, so they can
achieve the best possible performance for any given operation. Expressions should be a preferred way to manipulate your
data instead more "direct" API.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now let&#8217;s look at various types of expressions&#8230;&#8203;</p>
</div>
<div class="sect2">
<h3 id="_column_expressions">Column Expressions</h3>
<div class="paragraph">
<p><code>$str(..)</code> and <code>$decimal(..)</code> expressions in the example above are the column lookup expressions. They return a DataFrame
column with a given name or at a given (zero-based) position without applying any transformations to the data.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
So what is returned when you evaluate a column expression with a Series object? Series can be thought of as a
single (unnamed) column. So a column expression simply returns the Series unchanged, ignoring implied column
name or position.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Factory methods for column expressions are easy to spot in the <code>Exp</code> interface - they all start with a dollar sign.
Return type of the column expression is implied from the method name (<code>$str(..)</code> produces a <code>Series&lt;String&gt;</code>, <code>$decimal(..)</code> -
<code>Series&lt;BigDecimal&gt;</code>, <code>$int(..)</code> - <code>Series&lt;Integer&gt;</code>, <code>$date(..)</code> - <code>Series&lt;LocalDate&gt;</code> and so on).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
DFLib doesn&#8217;t do any type conversion of the original column data (the exception being <code>$bool</code>). So you
need to select the right type in your code to avoid ClassCastExceptions downstream.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_complex_expressions">Complex Expressions</h3>
<div class="paragraph">
<p>Expressions can be composed of other expressions by invoking static methods of <code>Exp</code> and type-specific instance
methods of various <code>Exp</code> subclasses. E.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// &quot;Condition&quot; is an Exp&lt;Boolean&gt; described in more detail below.</span>
<span class="predefined-type">Condition</span> c = and(
        <span class="error">$</span>str(<span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>).startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">A</span><span class="delimiter">&quot;</span></span>),
        <span class="error">$</span>decimal(<span class="string"><span class="delimiter">&quot;</span><span class="content">salary</span><span class="delimiter">&quot;</span></span>).add(<span class="error">$</span>decimal(<span class="string"><span class="delimiter">&quot;</span><span class="content">benefits</span><span class="delimiter">&quot;</span></span>)).gt(<span class="integer">100000</span>.)
);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_numeric_expressions">Numeric Expressions</h3>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect2">
<h3 id="_date_expressions">Date Expressions</h3>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect2">
<h3 id="_conditions">Conditions</h3>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect2">
<h3 id="sorter">Sorters</h3>
<div class="paragraph">
<p><code>Sorter</code> is a special object, that allows to <a href="#sort">sort DFLib data structures</a>. Internally a Sorter is using an
expression to retrieve values that comprise sorting criteria and index them in the specified order. Sorter can be
created from any expression by calling its <code>asc()</code> or <code>desc()</code> methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// sort by last name in the ascending order</span>
Sorter s = <span class="error">$</span>str(<span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>).asc();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
DFLib would allow you to create a Sorter based on any expression type. In runtime, the actual type must be
either a Java primitive or an instance of <code>Comparable</code>, or a ClassCastException will be thrown during sorting.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="selecting">Selecting Rows and Columns</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before analyzing or transforming a Series or a DataFrame, very often they need to be to narrowed down to just
the relevant data. API for selecting and filtering rows and columns described in this chapter helps with such task.</p>
</div>
<div class="sect2">
<h3 id="_selecting_columns">Selecting Columns</h3>
<div class="paragraph">
<p><code>selectColumns(..)</code> method allows to do a few things at once: select a subset of columns in the DataFrame,
reorder columns and even duplicate columns.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Selecting by column name. In the example below we are getting rid of the "middle" column and reordering "first" and
"last" columns:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">middle</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Cosin</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">M</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Juliana</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Walewski</span><span class="delimiter">&quot;</span></span>, <span class="predefined-constant">null</span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">O'Hara</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">J</span><span class="delimiter">&quot;</span></span>);

DataFrame df1 = df.selectColumns(<span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>last      first
--------- -------
Cosin     Jerry
Walewski  Juliana
O'Hara    Joan
3 rows x 2 columns</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Selecting by column position instead of the name:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">middle</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Cosin</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">M</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Juliana</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Walewski</span><span class="delimiter">&quot;</span></span>, <span class="predefined-constant">null</span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">O'Hara</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">J</span><span class="delimiter">&quot;</span></span>);

DataFrame df1 = df.selectColumns(<span class="integer">1</span>, <span class="integer">0</span>);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deleting_columns">Deleting Columns</h3>
<div class="paragraph">
<p><code>DataFrame.dropColumn(..)</code> and <code>dropColumns(..)</code> are complimentary to <code>selectColumns(..)</code>. They allow to remove one or
more columns, but do not affect the order of the remaining columns.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">middle</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Cosin</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">M</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Juliana</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Walewski</span><span class="delimiter">&quot;</span></span>, <span class="predefined-constant">null</span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">O'Hara</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">J</span><span class="delimiter">&quot;</span></span>);

DataFrame df1 = df.dropColumns(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">middle</span><span class="delimiter">&quot;</span></span>); <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Drop one or more columns from the DataFrame.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>last
---------
Cosin
Walewski
O'Hara
3 rows x 1 column</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_selecting_rows_by_position">Selecting Rows by Position</h3>
<div class="ulist">
<ul>
<li>
<p>Selecting a subset of rows by position. As there are no row labels in DFLib yet, selecting by position is the only
"direct" selection option. Just like with column selection, it allows to duplicate rows by referencing the same
position more than once, as well as reorder rows:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Cosin</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Juliana</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Walewski</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">O'Hara</span><span class="delimiter">&quot;</span></span>);

DataFrame df1 = df.selectRows(<span class="integer">2</span>, <span class="integer">0</span>, <span class="integer">0</span>);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>first last
----- ------
Joan  O'Hara
Jerry Cosin
Jerry Cosin
3 rows x 2 columns</pre>
</div>
</div>
<div id="selectRowsIndex" class="ulist">
<ul>
<li>
<p>Selecting using an index. You may precalulate an "index" (an <code>IntSeries</code>) of row positions and then use it for row
selection. An index often comes from applying a condition to a <code>Series</code> that is not a part of the <code>DataFrame</code>. E.g.:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Cosin</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Juliana</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Walewski</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">O'Hara</span><span class="delimiter">&quot;</span></span>);

IntSeries rowNumbers = <span class="keyword">new</span> IntSequenceSeries(<span class="integer">0</span>, df.height());

IntSeries selectionIndex = rowNumbers.indexInt(i -&gt; i % <span class="integer">3</span> == <span class="integer">0</span>); <i class="conum" data-value="1"></i><b>(1)</b>

DataFrame df1 = df.selectRows(selectionIndex);</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Index is calculated by applying a condition to a Series, that is not a part of the DataFrame, whose rows we are
selecting.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>first last
----- -----
Jerry Cosin
1 row x 2 columns</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_selecting_rows_by_condition">Selecting Rows by Condition</h3>
<div class="paragraph">
<p>Most often than not we don&#8217;t know specific positions of rows we would like to select, and instead would like to evaluate
each row against some condition to decide whether it should be included in the result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Cosin</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Juliana</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Walewski</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">O'Hara</span><span class="delimiter">&quot;</span></span>);

DataFrame df1 = df.selectRows(and(
        <span class="error">$</span>str(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>).startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">J</span><span class="delimiter">&quot;</span></span>),
        <span class="error">$</span>str(<span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>).startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">O</span><span class="delimiter">&quot;</span></span>)));</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>first last
----- ------
Joan  O'Hara
1 row x 2 columns</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Unlike positional select this flavor does not allow to reorder or duplicate rows.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the example above select condition was provided using the <code>Condition</code> object. You can also use a lambda function on a
single column:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Cosin</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Juliana</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Walewski</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">O'Hara</span><span class="delimiter">&quot;</span></span>);

DataFrame df1 = df.selectRows(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>,
        (<span class="predefined-type">String</span> f) -&gt; f != <span class="predefined-constant">null</span> &amp;&amp; f.startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">J</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or a lambda function on the entire row:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Cosin</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Juliana</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Walewski</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">O'Hara</span><span class="delimiter">&quot;</span></span>);

DataFrame df1 = df.selectRows(r -&gt;
        r.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>).toString().startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">J</span><span class="delimiter">&quot;</span></span>)
                &amp;&amp; r.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>).toString().startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">O</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, <code>BooleanSeries</code> can also serve as a filter condition (a "mask"). Such mask is usually a result of a prior logical
operation between Series. E.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Cosin</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Juliana</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Walewski</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">O'Hara</span><span class="delimiter">&quot;</span></span>);

Series&lt;<span class="predefined-type">String</span>&gt; names = Series.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">Sandra</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Anton</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>);
BooleanSeries mask = names.eq(df.getColumn(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>)); <i class="conum" data-value="1"></i><b>(1)</b>

DataFrame df1 = df.selectRows(mask);</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Mask is calculated by comparing a Series of names with DataFrame column of first names.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>first last
----- ------
Joan  O'Hara
1 row x 2 columns</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_head_and_tail">Head and Tail</h3>
<div class="paragraph">
<p>When you only need the "first N" or "last M" rows of a DataFrame (or values of a Series) you can use <code>head</code> and <code>tail</code>
operations. Here is how to get the top 2 rows of a DataFrame:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Cosin</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Juliana</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Walewski</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">O'Hara</span><span class="delimiter">&quot;</span></span>);

DataFrame df1 = df.head(<span class="integer">2</span>); <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Returns a new DataFrame with two top rows of the original DataFrame.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>first   last
------- ---------
Jerry   Cosin
Juliana Walewski
2 rows x 2 columns</pre>
</div>
</div>
<div class="paragraph">
<p><code>tail</code> works similarly, but returns the <em>last</em> N rows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df1 = df.tail(<span class="integer">1</span>);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>first last
----- ------
Joan  O'Hara
1 row x 2 columns</pre>
</div>
</div>
<div class="paragraph">
<p>The argument to either <code>head(..)</code> or <code>tail(..)</code> can be negative. In which case the operation skips the specified number
of elements either from the top or from the bottom, and returns the remaining elements. The following code returns a
new DataFrame after skipping the two top rows of the original DataFrame:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df1 = df.head(-<span class="integer">2</span>);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>first  last
------ ---------
Joan  O'Hara
1 row x 2 columns</pre>
</div>
</div>
<div class="paragraph">
<p><code>Series</code> also define <code>head(..)</code> and <code>tail(..)</code> operations that do what you&#8217;d expect from them, returning first or last N
values.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Unlike index operations on arrays and lists in Java, <code>head(..)</code> and <code>tail(..)</code> are safe in regards to bounds
checking. They DO NOT throw exceptions when the length parameter is bigger than DataFrame height (or Series size),
returning an empty DataFame (or Series) instead.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="column-manipulation">Columns Manipulation</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="#selecting">Selecting rows and columns</a>, described in the previous chapter, is intended to produce a desired subset of
data. Here we&#8217;ll demonstrate methods for DataFrame columns manipulation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adding columns with new data, that may or may not be derived from the data in other DataFrame columns</p>
</li>
<li>
<p>Renaming columns</p>
</li>
<li>
<p>Transforming column data, converting it to a specific Java type and optimizing memory usage</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="adding-columns">Adding Columns</h3>
<div class="paragraph">
<p>There are a few ways to add columns to a DataFrame. A rather common case is adding a column by calculating cell values
based on data from other columns:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Cosin</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Juliana</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Walewski</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">O'Hara</span><span class="delimiter">&quot;</span></span>);

DataFrame df1 = df.addColumn(
        concat(<span class="error">$</span>str(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>), <span class="error">$</span>val(<span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>), <span class="error">$</span>str(<span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>)) <i class="conum" data-value="1"></i><b>(1)</b>
                .as(<span class="string"><span class="delimiter">&quot;</span><span class="content">full</span><span class="delimiter">&quot;</span></span>)  <i class="conum" data-value="2"></i><b>(2)</b>
);</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Expression producing the column by concatenating values of other columns</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>"as" sets the name of the final expression, which will be the name of the new column</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The same can be done using a lambda instead of an expression (though the Expression API should be preferred) :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Cosin</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Juliana</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Walewski</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">O'Hara</span><span class="delimiter">&quot;</span></span>);

DataFrame df1 = df.addColumn(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">full</span><span class="delimiter">&quot;</span></span>,                                   <i class="conum" data-value="1"></i><b>(1)</b>
        r -&gt; r.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>) + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span> + r.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="2"></i><b>(2)</b>
);</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>New column name</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Operation to produce values for the new column from the existing row. <code>r</code> is a special <code>RowProxy</code> object,
providing access to the row being processed.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Multiple columns can be added in a single method call:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df1 = df.addColumns(
        <span class="error">$</span>str(<span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>).mapVal(s -&gt; s.charAt(<span class="integer">0</span>)).as(<span class="string"><span class="delimiter">&quot;</span><span class="content">last_initial</span><span class="delimiter">&quot;</span></span>),
        <span class="error">$</span>str(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>).mapVal(s -&gt; s.charAt(<span class="integer">0</span>)).as(<span class="string"><span class="delimiter">&quot;</span><span class="content">first_initial</span><span class="delimiter">&quot;</span></span>)
);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>first   last      last_initial first_initial
------- --------- ------------ -------------
Jerry   Cosin     C            J
Juliana Walewski  G            A
Joan    O'Hara    O            J
3 rows x 4 columns</pre>
</div>
</div>
<div class="paragraph">
<p>If you have a Series object of the size matching the DataFrame height, it can be added as a
column. E.g. we can add a column that will number DataFrame rows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">IntSeries rowNumbers = <span class="keyword">new</span> IntSequenceSeries(<span class="integer">1</span>, df.height() + <span class="integer">1</span>); <i class="conum" data-value="1"></i><b>(1)</b>
DataFrame df1 = df.addColumn(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">number</span><span class="delimiter">&quot;</span></span>,
        rowNumbers
);</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>IntSequenceSeries</code> is a special Series that produces a sequence of numbers in the specified range</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>first   last      number
------- --------- ------
Jerry   Cosin          1
Juliana Walewski       2
Joan    O'Hara         3
3 rows x 3 columns</pre>
</div>
</div>
<div class="paragraph">
<p>For this particular task (adding row numbers) there&#8217;s a shortcut that does the same thing as the code above:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df1 = df.addRowNumberColumn(<span class="string"><span class="delimiter">&quot;</span><span class="content">number</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_renaming_columns">Renaming Columns</h3>
<div class="paragraph">
<p>Often DataFrames come from external sources (like CSV files or database tables) with column names requiring further
cleanup to match the expectations of the application. There are a number of ways to rename columns:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Rename individual columns:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Cosin</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">O'Hara</span><span class="delimiter">&quot;</span></span>);

DataFrame df1 = df
        .renameColumn(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">first_name</span><span class="delimiter">&quot;</span></span>)
        .renameColumn(<span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last_name</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>first_name last_name
---------- ---------
Jerry      Cosin
Joan       O'Hara
2 rows x 2 columns</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Specify the new names of <em>all</em> columns at once. This may not be practical for a large number of columns:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Cosin</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">O'Hara</span><span class="delimiter">&quot;</span></span>);

DataFrame df1 = df.renameColumns(<span class="string"><span class="delimiter">&quot;</span><span class="content">first_name</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last_name</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>first_name last_name
---------- ---------
Jerry      Cosin
Joan       O'Hara
2 rows x 2 columns</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Rename using a map of old names to new names. Names not present in the map will remain unchanged:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; nameMap = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;&gt;();
nameMap.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">first_name</span><span class="delimiter">&quot;</span></span>);

DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Cosin</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">O'Hara</span><span class="delimiter">&quot;</span></span>);

DataFrame df1 = df.renameColumns(nameMap);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>first_name last
---------- ------
Jerry      Cosin
Joan       O'Hara
2 rows x 2 columns</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Rename using a function, applied to all column names in turn. This is useful e.g. to convert all names to lower case:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">FIRST</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">LAST</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Cosin</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">O'Hara</span><span class="delimiter">&quot;</span></span>);

DataFrame df1 = df.renameColumns(<span class="predefined-type">String</span>::toLowerCase);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>first last
----- ------
Jerry Cosin
Joan  O'Hara
2 rows x 2 columns</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="transforming-columns">Transforming Columns</h3>
<div class="paragraph">
<p>A column in a DataFrame can be transformed in various ways. The most generic transformation method is <code>replaceColumn(..)</code>,
allowing to apply an expression to the entire DataFrame, and then replace an existing column with the result. E.g. here
is how to perform type conversions on a column:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">year</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">sales</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">2022</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">2005365.01</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">2023</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">4355098.75</span><span class="delimiter">&quot;</span></span>);

DataFrame df1 = df
        .replaceColumn(<span class="integer">0</span>, Exp.<span class="error">$</span>str(<span class="integer">0</span>).castAsInt())
        .replaceColumn(<span class="integer">1</span>, Exp.<span class="error">$</span>str(<span class="integer">1</span>).castAsDecimal());</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_compacting_columns">Compacting Columns</h4>
<div class="paragraph">
<p>A special kind of column transformations is converting columns to primitives. The values in the columns to be converted
can be Numbers or Strings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df1 = df
        .compactInt(<span class="string"><span class="delimiter">&quot;</span><span class="content">year</span><span class="delimiter">&quot;</span></span>, <span class="integer">0</span>) <i class="conum" data-value="1"></i><b>(1)</b>
        .compactDouble(<span class="string"><span class="delimiter">&quot;</span><span class="content">sales</span><span class="delimiter">&quot;</span></span>, <span class="integer">0</span>.);</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The second method argument is the primitive value to use if the value being converted is null</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>compactInt(..)</code>, <code>compactDouble(..)</code> and other similar methods are not just syntactic sugar. They convert
DataFrame columns to <em>primitive</em> Series, that take significantly less memory (hence, the name "compact") and compute
most operations faster than Object-based Series. So you should consider using them where possible.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cleaning_up_data">Cleaning up Data</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Data coming to DFLib may be of varying quality and hence may require cleanup before processing. We&#8217;ve already discussed
<a href="#changing-column-type">column type conversion</a> operation, that allows to normalize data among other things. Another
typical case of data requiring cleanup is missing values. Such values are represented as regular Java <code>nulls</code>. There
is a variety of reasons why data can be missing. A rather common one is outer joins and concatenation operations
described further down in this document.</p>
</div>
<div class="paragraph">
<p>In all of these cases you may have to guess or extrapolate the actual values based on some internal knowledge of the
dataset. There are methods in both <code>Series</code> and <code>DataFrame</code> that allow to replace nulls with either fixed values or
values from adjacent cells. First, let&#8217;s see how this works for <code>Series</code>&#8230;&#8203;</p>
</div>
<div class="sect2">
<h3 id="_filling_nulls_in_series">Filling Nulls in Series</h3>
<div class="paragraph">
<p>The simplest approach is to replace nulls with a constant value:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Series&lt;<span class="predefined-type">String</span>&gt; withNulls = Series.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">b</span><span class="delimiter">&quot;</span></span>, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">c</span><span class="delimiter">&quot;</span></span>);
Series&lt;<span class="predefined-type">String</span>&gt; filled = withNulls.fillNulls(<span class="string"><span class="delimiter">&quot;</span><span class="content">X</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>a
b
X
X
c
5 elements</pre>
</div>
</div>
<div class="paragraph">
<p>Another strategy is to use values adjacent to the cells with nulls:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Series&lt;<span class="predefined-type">String</span>&gt; filled = withNulls.fillNullsForward(); <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>fillNullsForward(..)</code> takes a non-null value preceding the null cell and uses it to replace nulls.
Similarly, there&#8217;s a <code>fillNullsBackward(..)</code> method that uses the value following the null cell.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>a
b
b
b
c
5 elements</pre>
</div>
</div>
<div class="paragraph">
<p>Finally, there&#8217;s a way to fill nulls using another <code>Series</code> object as a kind of "template" or "mask" :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Series&lt;<span class="predefined-type">String</span>&gt; mask = Series.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">A</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">B</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">C</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">D</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">E</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">F</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">G</span><span class="delimiter">&quot;</span></span>);
Series&lt;<span class="predefined-type">String</span>&gt; filled = withNulls.fillNullsFromSeries(mask);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>a
b
C
D
c
5 elements</pre>
</div>
</div>
<div class="paragraph">
<p>Notice that the "mask" Series can be longer (or shorter) than the Series where the nulls are replaced.
Values between the two Series objects are aligned by position starting at zero.</p>
</div>
</div>
<div class="sect2">
<h3 id="_filling_nulls_in_dataframe">Filling Nulls in DataFrame</h3>
<div class="paragraph">
<p>Filling nulls in a DataFrame is done by column, so the API is very similar to <code>Series.fillNulls*(..)</code> methods, only with
an additional String on integer argument specifying column position.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame withNulls = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">c1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">c2</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span>,
        <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">2</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">2</span><span class="delimiter">&quot;</span></span>);

DataFrame filled = withNulls
        .fillNullsBackwards(<span class="string"><span class="delimiter">&quot;</span><span class="content">c1</span><span class="delimiter">&quot;</span></span>)
        .fillNullsForward(<span class="string"><span class="delimiter">&quot;</span><span class="content">c2</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>c1 c2
-- --
1  1
2  1
2  2
3 rows x 2 columns</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sort">Sorting</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can sort values in <code>Series</code>, and sort rows in <code>DataFrames</code>. As is the case everywhere else in DFLib, sorting does
not alter the original object, and instead creates a new instance of either Series or DataFrame.</p>
</div>
<div class="paragraph">
<p>First let&#8217;s look at sorting Series&#8230;&#8203;</p>
</div>
<div class="sect2">
<h3 id="_sorting_series">Sorting Series</h3>
<div class="paragraph">
<p>Series provides a <code>sort</code> method to sort its data using a <a href="#sorter">sorter</a> built from an expression:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// sort series by String length</span>
Series&lt;<span class="predefined-type">String</span>&gt; s = Series
        .of(<span class="string"><span class="delimiter">&quot;</span><span class="content">12</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">123</span><span class="delimiter">&quot;</span></span>)
        .sort(<span class="error">$</span>str(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>).mapVal(<span class="predefined-type">String</span>::length).asc());</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result is a new Series with sorted data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>1
12
123
3 elements</pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively the same can be achieved using a Comparator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Series&lt;<span class="predefined-type">String</span>&gt; s = Series
        .of(<span class="string"><span class="delimiter">&quot;</span><span class="content">12</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">123</span><span class="delimiter">&quot;</span></span>)
        .sort(<span class="predefined-type">Comparator</span>.comparingInt(<span class="predefined-type">String</span>::length));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The next example shows how to sort Series in the "natural" order (alphabetically for Strings):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Series&lt;<span class="predefined-type">String</span>&gt; s = Series
        .of(<span class="string"><span class="delimiter">&quot;</span><span class="content">c</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">d</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>)
        .sort(<span class="error">$</span>str(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>).asc());</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>a
c
d
3 elements</pre>
</div>
</div>
<div class="paragraph">
<p>Series of primitives have methods to sort values in the natural order without an explicit sorter or comparator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">LongSeries s = Series
        .ofLong(<span class="predefined-type">Long</span>.MAX_VALUE, <span class="integer">15L</span>, <span class="integer">0L</span>)
        .sortLong();</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>                  0
                 15
9223372036854775807
3 elements</pre>
</div>
</div>
<div class="paragraph">
<p>Additionally, <code>IntSeries</code> has an optimized method to sort ints with a custom <code>IntComparator</code>.</p>
</div>
<div class="paragraph">
<p>Next we&#8217;ll check how to sort a DataFrame.</p>
</div>
</div>
<div class="sect2">
<h3 id="_sorting_dataframe">Sorting DataFrame</h3>
<div class="paragraph">
<p>Rows in a DataFrame can be sorted with one or more <a href="#sorter">sorters</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Just like in other places where a Sorter might be
used, there is an assumption that the Sorter expression produces values that are either Java primitives or are
compatible with <code>java.lang.Comparable</code> (i.e., Strings, numbers, etc).
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">middle</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Cosin</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">M</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Juliana</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Walewski</span><span class="delimiter">&quot;</span></span>, <span class="predefined-constant">null</span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Albert</span><span class="delimiter">&quot;</span></span>, <span class="predefined-constant">null</span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">O'Hara</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">J</span><span class="delimiter">&quot;</span></span>);

DataFrame df1 = df.sort(
        <span class="error">$</span>str(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>).asc(),
        <span class="error">$</span>str(<span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>).asc());</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>first   last      middle
------- --------- ------
Juliana Walewski  null
Jerry   Albert    null
Jerry   Cosin     M
Joan    O'Hara    J
4 rows x 3 columns</pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively sorting can be done by a single column name or an array of columns. The assumption is the same as above
- values in columns used for sorting must be either Java primitive or implement <code>java.lang.Comparable</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">middle</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Cosin</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">M</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Juliana</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Walewski</span><span class="delimiter">&quot;</span></span>, <span class="predefined-constant">null</span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">O'Hara</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">J</span><span class="delimiter">&quot;</span></span>);

DataFrame df1 = df.sort(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="predefined-constant">true</span>); <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The first argument is the column name (can also be column integer index), the second - a boolean indicating sort
direction (<code>true</code> for ascending, <code>false</code> - for descending order).</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">middle</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Cosin</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">M</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Juliana</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Walewski</span><span class="delimiter">&quot;</span></span>, <span class="predefined-constant">null</span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Albert</span><span class="delimiter">&quot;</span></span>, <span class="predefined-constant">null</span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">O'Hara</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">J</span><span class="delimiter">&quot;</span></span>);

DataFrame df1 = df.sort(<span class="keyword">new</span> <span class="predefined-type">String</span><span class="type">[]</span>{<span class="string"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>}, <span class="keyword">new</span> <span class="type">boolean</span><span class="type">[]</span>{<span class="predefined-constant">true</span>, <span class="predefined-constant">false</span>});</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_concatenating">Concatenating</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are various ways to combine data from multiple <code>Series</code> or <code>DataFrames</code>. The simplest is <em>concatenation</em>,
described in this chapter. Series can be concatenated together producing a longer Series. DataFrames can be concatenated
either vertically (along the rows axis) or horizontally (along the columns axis).</p>
</div>
<div class="sect2">
<h3 id="_concatenating_series">Concatenating Series</h3>
<div class="paragraph">
<p>If you have a Series object and want to concatenate it with one or more other Series, you&#8217;d use <code>Series.concat(..)</code>
method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Series&lt;<span class="predefined-type">String</span>&gt; s1 = Series.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">x</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">y</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">z</span><span class="delimiter">&quot;</span></span>);
Series&lt;<span class="predefined-type">String</span>&gt; s2 = Series.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>);
Series&lt;<span class="predefined-type">String</span>&gt; s3 = Series.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">m</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">n</span><span class="delimiter">&quot;</span></span>);

Series&lt;<span class="predefined-type">String</span>&gt; sConcat = s1.concat(s2, s3);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result is as expected contains values of all Series put together:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>x
y
z
a
m
n
6 elements</pre>
</div>
</div>
<div class="paragraph">
<p>If you have a collection or an array of Series and want to "glue" them together, you can use a static
<code>SeriesConcat.concat(..)</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Collection</span>&lt;Series&lt;<span class="predefined-type">String</span>&gt;&gt; ss = asList(
        Series.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">x</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">y</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">z</span><span class="delimiter">&quot;</span></span>),
        Series.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>),
        Series.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">m</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">n</span><span class="delimiter">&quot;</span></span>));

Series&lt;<span class="predefined-type">String</span>&gt; sConcat = SeriesConcat.concat(ss);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result is the same as in the previous example. Also you can concatenate Series with itself:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Series&lt;<span class="predefined-type">String</span>&gt; s = Series.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">x</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">y</span><span class="delimiter">&quot;</span></span>);
Series&lt;<span class="predefined-type">String</span>&gt; sConcat = s.concat(s);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>x
y
x
y
4 elements</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_concatenating_dataframes">Concatenating DataFrames</h3>
<div class="paragraph">
<p>DataFrame offers two options for concatenation - <em>vertical</em> (stacking DataFrames on top of each other) and <em>horizontal</em>
(putting them next to each other). Let&#8217;s see some examples..</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df1 = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">b</span><span class="delimiter">&quot;</span></span>).of(
        <span class="integer">1</span>, <span class="integer">2</span>,
        <span class="integer">3</span>, <span class="integer">4</span>);

DataFrame df2 = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">b</span><span class="delimiter">&quot;</span></span>).of(
        <span class="integer">5</span>, <span class="integer">6</span>,
        <span class="integer">7</span>, <span class="integer">8</span>);

DataFrame dfv = df1.vConcat(df2); <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Concatenate this and another DataFrame vertically. The argument is a vararg, so more than one DataFrame can be
passed to the method.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>a b
- -
1 2
3 4
5 6
7 8
4 rows x 2 columns</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame dfh = df1.hConcat(df2); <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Concatenate this and another DataFrame horizontally. The argument is a vararg, so more than one DataFrame can be
passed to the method.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>a b a_ b_
- - -- --
1 2 5  6
3 4 7  8
2 rows x 4 columns</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Since both <code>df1</code> and <code>df2</code> had the same column names, and a DataFrame must only have unique columns, <code>_</code> suffix was
automatically appended to the conflicting columns in the resulting DataFrame. We will see this auto-renaming behavior
in other places, such as joins.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>So far all our concatenation examples consisted of DataFrames that had matching dimensions (same number and names of
columns for <code>vConcat</code> and same number of rows for <code>hConcat</code>). But what if concatenated DataFrames are shaped or named
differently?</p>
</div>
<div class="paragraph">
<p>Concat methods may take an extra "how" parameter to define concatenation semantics. The type of the "how" parameter is
<code>JoinType</code>, and can be one of <code>inner</code> (default), <code>left</code>, <code>right</code>, <code>full</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We&#8217;ll see <code>JoinType</code> again soon when discussing <a href="#joins">joins</a>. Concatenation and joins are related fairly
closely.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s look how this works with <code>vConcat</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df1 = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">b</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>).of(
        <span class="integer">1</span>, <span class="integer">2</span>,
        <span class="integer">3</span>, <span class="integer">4</span>);

DataFrame df2 = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">c</span><span class="delimiter">&quot;</span></span>).of( <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="integer">5</span>, <span class="integer">6</span>,
        <span class="integer">7</span>, <span class="integer">8</span>);

DataFrame dfv = df1.vConcat(JoinType.inner, df2); <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>df1</code> column names are "b" and "c", while <code>df2</code> - "a" and "c".</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Explicitly passing <code>JoinType.inner</code> to <code>vConcat</code>. It is done to demonstrate the point. Since <code>inner</code> is the
default, omitting it will not change the outcome.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>a
-
2
4
5
7
4 rows x 1 column</pre>
</div>
</div>
<div class="paragraph">
<p>As you can see in the result, the behavior of <code>inner</code> join is to only keep columns that are present in both <code>df1</code> and
<code>df2</code>. Columns are joined by name, regardless of their order (though the order of columns is preserved in the result,
following the order in each DataFame being joined, left to right).</p>
</div>
<div class="paragraph">
<p>Changing semantics from <code>inner</code> to <code>left</code> gives us all the columns of the leftmost DataFrame, but those columns that
are missing from the concatenated DataFrame are filled with nulls in the corresponding positions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame dfv = df1.vConcat(JoinType.left, df2);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>b    a
---- -
1    2
3    4
null 5
null 7
4 rows x 2 columns</pre>
</div>
</div>
<div class="paragraph">
<p>Leaving it as an exercise for the reader to try <code>right</code> and <code>full</code> joins.</p>
</div>
<div class="paragraph">
<p><code>hConcat</code> works similarly, however concatenation is done by row <em>position</em>, as there are no row names:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df1 = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">b</span><span class="delimiter">&quot;</span></span>).of(
        <span class="integer">1</span>, <span class="integer">2</span>,
        <span class="integer">3</span>, <span class="integer">4</span>,
        <span class="integer">5</span>, <span class="integer">6</span>);

DataFrame df2 = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">c</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">d</span><span class="delimiter">&quot;</span></span>).of(
        <span class="integer">7</span>, <span class="integer">8</span>,
        <span class="integer">9</span>, <span class="integer">10</span>);

DataFrame dfv = df1.hConcat(JoinType.left, df2);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>a b c    d
- - ---- ----
1 2 7    8
3 4 9    10
5 6 null null
3 rows x 4 columns</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="joins">Joins</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you worked with relational databases before, you know what "joins" are. This is a way to combine related rows from
multiple tables. DataFrames can be joined together, just like two DB tables. DFLib provides 4 familiar flavors of joins:
<code>inner</code>, <code>left</code> (outer), <code>right</code> (outer) and <code>full</code> (outer).</p>
</div>
<div class="sect2">
<h3 id="_inner_join">Inner Join</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame left = DataFrame
        .foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>)
        .of(<span class="integer">1</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="integer">2</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Juliana</span><span class="delimiter">&quot;</span></span>, <span class="integer">3</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>);

DataFrame right = DataFrame
        .foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span>)
        .of(<span class="integer">2</span>, <span class="integer">25</span>, <span class="integer">3</span>, <span class="integer">30</span>, <span class="integer">4</span>, <span class="integer">40</span>);

DataFrame joined = left
        .innerJoin() <i class="conum" data-value="1"></i><b>(1)</b>
        .on(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="2"></i><b>(2)</b>
        .with(right);</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Since we used <code>innerJoin()</code>, only the rows that are present in both DataFrames will be included in the result below.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Columns used in the join criteria have the same name in both DataFrames, so we can specify the name of the join column
only once. In general, the names do not need to match, and multiple columns can participate in a join.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>id name    id_ age
-- ------- --- ---
 2 Juliana   2  25
 3 Joan      3  30
2 rows x 4 columns</pre>
</div>
</div>
<div class="paragraph">
<p>Notice how DFLib treats the <code>id</code> column in the join result. Since it is present in both left and right DataFrames, it
is included in the result twice, but the second column is renamed to <code>id_</code> to avoid a naming collision. The same renaming
would occur for any other columns from the right DataFrame that have conflicting names with the columns from the left.
A quick way to get rid of duplicate columns is to drop them by the name pattern:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame joined = left
        .innerJoin()
        .on(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>)
        .with(right)
        .dropColumns(c -&gt; c.endsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">_</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>id name    age
-- ------- ---
 2 Juliana  25
 3 Joan     30
2 rows x 3 columns</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_outer_joins">Outer Joins</h3>
<div class="paragraph">
<p>Now let&#8217;s demonstrate outer joins. Here is a <code>leftJoin(..)</code> example using the same left and right DataFrames:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame joined = left
        .leftJoin()
        .on(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>)
        .with(right);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>id name     id_  age
-- ------- ---- ----
 1 Jerry   null null
 2 Juliana    2   25
 3 Joan       3   30
3 rows x 4 columns</pre>
</div>
</div>
<div class="paragraph">
<p>It has all the rows from the left DataFrame, and only the matching rows from the right DataFrame. For left rows with no
matching right rows, the right columns are filled with <code>null</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_indicator_column">Indicator Column</h3>
<div class="paragraph">
<p>Join API allows to explicitly identify which rows had a match, and which didn&#8217;t by adding a special "indicator" column.
Let&#8217;s show it on a <code>fullJoin(..)</code> example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame joined = left
        .fullJoin()
        .on(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>)
        .indicatorColumn(<span class="string"><span class="delimiter">&quot;</span><span class="content">join_type</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>
        .with(right)
        .dropColumns(c -&gt; c.endsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">_</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Request an indicator column with a user-specified name.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>  id name     age join_type
---- ------- ---- ----------
   1 Jerry   null left_only
   2 Juliana   25 both
   3 Joan      30 both
null null      40 right_only
4 rows x 4 columns</pre>
</div>
</div>
<div class="paragraph">
<p>The "join_type" column will contain a special enum <code>com.nhl.dflib.join.JoinIndicator</code> that allows to categorize rows
in the produced DataFrame.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
indicator column can be requested for all join types, but it is only useful for the three outer joins (it will
always be <code>both</code> for inner joins).
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_nested_loop_joins">Nested Loop Joins</h3>
<div class="paragraph">
<p>The joins we&#8217;ve seen so far were all based on comparing left and right column values. They are knows as "hash joins",
and are usually fast and efficient. However, they can not express every possible condition, and sometimes we have
to resort to another kind of joins - "nested loop", that would compare every row from the left DataFrame to every row
from the right. For instance, let&#8217;s join a DataFrame of salaries with itself to produce pairs of names - a person with
higher salary on the left vs. everyone with lower salary on the right:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">salary</span><span class="delimiter">&quot;</span></span>).of(
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry</span><span class="delimiter">&quot;</span></span>, <span class="integer">120</span>_000,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Juliana</span><span class="delimiter">&quot;</span></span>, <span class="integer">80</span>_000,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan</span><span class="delimiter">&quot;</span></span>, <span class="integer">95</span>_000);

DataFrame joined = df
        .leftJoin()
        .predicatedBy((r1, r2) -&gt; ((<span class="predefined-type">Integer</span>) r1.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">salary</span><span class="delimiter">&quot;</span></span>)) &gt; ((<span class="predefined-type">Integer</span>) r2.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">salary</span><span class="delimiter">&quot;</span></span>))) <i class="conum" data-value="1"></i><b>(1)</b>
        .with(df)
        .sort(<span class="error">$</span><span class="type">int</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">salary</span><span class="delimiter">&quot;</span></span>).desc(), <span class="error">$</span><span class="type">int</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">salary_</span><span class="delimiter">&quot;</span></span>).desc()) <i class="conum" data-value="2"></i><b>(2)</b>
        .renameColumn(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">makes_more</span><span class="delimiter">&quot;</span></span>)
        .renameColumn(<span class="string"><span class="delimiter">&quot;</span><span class="content">name_</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">makes_less</span><span class="delimiter">&quot;</span></span>)
        .dropColumns(c -&gt; c.startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">salary</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Custom join condition</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Sorting and renaming the result columns for more user-friendly display</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>makes_more makes_less
---------- ----------
Jerry      Joan
Jerry      Juliana
Joan       Juliana
Juliana    null
4 rows x 2 columns</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Nested loop joins are <em>much</em> slower, and should be avoided unless absolutely necessary.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="grouping">Grouping and Aggregating</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="window">Window functions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="pivot">Pivot</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="stack">Stack</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jdbc">Working with Relational Databases</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Relational databases are arguably the most important type of data stores out there. Also they happen to map
really well to DataFrames. DFLib provides advanced support for loading and saving DataFrames to RDBMS. It supports
transactions, auto-generation of certain SQL statements, merging of data on top of the existing data
("create-or-update"), building custom SQL for selects and updates. It knows how to treat different DB
"flavors" and does a number of other cool database-related things.</p>
</div>
<div class="paragraph">
<p>To start using all this, you need to import <code>dflib-jdbc</code> module:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>com.nhl.dflib<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>dflib-jdbc<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span>

<span class="comment">&lt;!-- Of course you also need to import your preferred JDBC driver --&gt;</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_jdbcconnector">JdbcConnector</h3>
<div class="paragraph">
<p>Once the imports are setup, you&#8217;d use <code>Jdbc</code> class to obtain an instance of <code>JdbcConnector</code> that can be later used for
all DB operations. You may already have a preconfigured <code>javax.sql.DataSource</code>, so the simplest way to create a
connector is to pass that DataSource to <code>Jdbc</code> factory method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">JdbcConnector connector = Jdbc.connector(dataSource);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively you can build everything from scratch:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">JdbcConnector connector = Jdbc
        .connector(<span class="string"><span class="delimiter">&quot;</span><span class="content">jdbc:derby:target/derby/mydb;create=true</span><span class="delimiter">&quot;</span></span>)
        <span class="comment">// .driver(&quot;com.foo.MyDriver&quot;) </span><i class="conum" data-value="1"></i><b>(1)</b>
        <span class="comment">// .userName(&quot;root&quot;)</span>
        <span class="comment">// .password(&quot;secret&quot;) </span><i class="conum" data-value="2"></i><b>(2)</b>
        .build();</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>(Optional) Driver name. Some drivers are not properly registered with the DriverManager, and require an explicit
declaration.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>DB account username/password (not needed for our in-memory Derby example, but will definitely be required for a real database).</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_tableloader_tablesaver">TableLoader / TableSaver</h3>
<div class="paragraph">
<p>Once you have the connector, you can start reading and persisting DataFrame data. Many DataFrames map directly to
individual tables (or views) defined in the database. For those DFLib provides a set of rather straightforward
operations that do not require the user to write SQL (all needed SQL is auto-generated by the framework):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = connector.tableLoader(<span class="string"><span class="delimiter">&quot;</span><span class="content">person</span><span class="delimiter">&quot;</span></span>).load();</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>id name              salary
-- ----------------- --------
 1 Jerry Cosin       70000.0
 2 Juliana Walewski  85000.0
 3 Joan O'Hara       101000.0
3 rows x 3 columns</pre>
</div>
</div>
<div class="paragraph">
<p>Table loader provides a way to customize the load operation. It allows to select specific columns, set the maximum
number of rows to read, sample rows, and even specify fetch condition as another DataFrame. Some examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame condition = DataFrame
        .byColumn(<span class="string"><span class="delimiter">&quot;</span><span class="content">salary</span><span class="delimiter">&quot;</span></span>)
        .of(Series.ofInt(<span class="integer">70</span>_000, <span class="integer">101</span>_000));

DataFrame df = connector.tableLoader(<span class="string"><span class="delimiter">&quot;</span><span class="content">person</span><span class="delimiter">&quot;</span></span>)
        .includeColumns(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">salary</span><span class="delimiter">&quot;</span></span>)
        .eq(condition)
        .load();</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>name        salary
----------- --------
Jerry Cosin 70000.0
Joan O'Hara 101000.0
2 rows x 2 columns</pre>
</div>
</div>
<div class="paragraph">
<p>What it doesn&#8217;t require (unlike <a href="#csv">CSV loader</a>) is explicit column types, as the proper value types are inferred
from the database metadata.</p>
</div>
<div class="paragraph">
<p>Table saver allows to save DataFrame to a table. Column names in the DataFrame should match column names in the DB table:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.byArrayRow(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">salary</span><span class="delimiter">&quot;</span></span>)
        .appender()
        .append(<span class="integer">1</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Jerry Cosin</span><span class="delimiter">&quot;</span></span>, <span class="integer">70</span>_000)
        .append(<span class="integer">2</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Juliana Walewski</span><span class="delimiter">&quot;</span></span>, <span class="integer">85</span>_000)
        .append(<span class="integer">3</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Joan O'Hara</span><span class="delimiter">&quot;</span></span>, <span class="integer">101</span>_000)
        .toDataFrame();

connector.tableSaver(<span class="string"><span class="delimiter">&quot;</span><span class="content">person</span><span class="delimiter">&quot;</span></span>).save(df);</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this scenario table saver executes insert for each DataFrame row. But what if there is already an existing data
in the table? There are a few options the user has to overwrite or merge the data:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Append the data (that&#8217;s what we effectively did above).</p>
</li>
<li>
<p>Delete all existing data before doing the insert.</p>
</li>
<li>
<p>Merge the data by comparing DataFrame and DB table data on PK column(s) or an arbitrary set of columns. Insert missing
rows, update the existing rows. If the table has more columns than there are columns in the DataFrame, the data in those
extra columns is preserved.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Delete before insert example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">connector.tableSaver(<span class="string"><span class="delimiter">&quot;</span><span class="content">person</span><span class="delimiter">&quot;</span></span>)
        .deleteTableData()
        .save(df);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Merge by PK example (PK columns are detected from DB metadata) :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">connector.tableSaver(<span class="string"><span class="delimiter">&quot;</span><span class="content">person</span><span class="delimiter">&quot;</span></span>)
        .mergeByPk()
        .save(df);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sqlloader_sqlsaver">SqlLoader / SqlSaver</h3>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="csv">Working with .csv Files</h2>
<div class="sectionbody">
<div class="paragraph">
<p>CSV (comma-separated values) is a very common and rather simple format for working with raw data. CSV files can be
manipulated programmatically or manually (via Excel/LibreOffice), loaded to / from databases, etc. DFLib supports
reading DataFrames from CSV and storing them to CSV. You need to add an extra dependency to your project to take
advantage of this functionality:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>com.nhl.dflib<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>dflib-csv<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Once you do that, <code>Csv</code> class is the entry point to all the <code>.csv</code> related operations as discussed
below.</p>
</div>
<div class="sect2">
<h3 id="_reading_dataframe_from_csv">Reading DataFrame from CSV</h3>
<div class="paragraph">
<p>The simplest API for reading a CSV is this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = Csv.load(<span class="string"><span class="delimiter">&quot;</span><span class="content">src/test/resources/f1.csv</span><span class="delimiter">&quot;</span></span>); <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The argument to the "load" method can be a filename, a file, or a Reader, so it can be loaded from a variety of
sources.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The result is a DataFrame that matches CSV structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>A B
- --
1 s1
4 s2
2 rows x 2 columns</pre>
</div>
</div>
<div class="paragraph">
<p>DFLib made a few assumptions about the data in <code>f1.csv</code>, namely that the first row represents
column names, that all columns are Strings, and that all of them need to be included. These assumptions are not
necessarily true with many data sets. So there is a longer form of this API that allows to configure column types,
skip rows and columns, or even sample the data without loading the entire CSV in memory. Some examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = Csv.loader() <i class="conum" data-value="1"></i><b>(1)</b>
        .skipRows(<span class="integer">1</span>) <i class="conum" data-value="2"></i><b>(2)</b>
        .header(<span class="string"><span class="delimiter">&quot;</span><span class="content">x</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">y</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="3"></i><b>(3)</b>
        .intColumn(<span class="string"><span class="delimiter">&quot;</span><span class="content">x</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="4"></i><b>(4)</b>
        .load(<span class="string"><span class="delimiter">&quot;</span><span class="content">src/test/resources/f1.csv</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Instead of "load" method use "loader".</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Skip the header row.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Provide our own header.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Convert the first column to int.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>x y
- --
1 s1
4 s2
2 rows x 2 columns</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In theory you don&#8217;t have to do most of these tweaks via CSV loader. You can load the raw data, and then use
standard DataFrame transformations to shape the result. However doing it via the loader allows to optimize
both load speed and memory use, so it is usually preferable.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_writing_dataframe_to_a_csv">Writing DataFrame to a CSV</h3>
<div class="paragraph">
<p>Writing to a CSV is equally easy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Csv.save(df, <span class="string"><span class="delimiter">&quot;</span><span class="content">target/df.csv</span><span class="delimiter">&quot;</span></span>); <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The argument to the "save" method can be a filename, a file, a Writer (or generally Appendable), so it can be stored
to a variety of destinations.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Just like with the loader, CSV saver provides its own set of options, if the defaults are not sufficient:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Csv.saver() <i class="conum" data-value="1"></i><b>(1)</b>
        .createMissingDirs() <i class="conum" data-value="2"></i><b>(2)</b>
        .format(CSVFormat.EXCEL) <i class="conum" data-value="3"></i><b>(3)</b>
        .save(df, <span class="string"><span class="delimiter">&quot;</span><span class="content">target/csv/df.csv</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Instead of "save" method use "saver" to be able to customize the process.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If intermediate directories for the output file are missing, create them.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Provide an alternative format (either from a collection of known formats, or user-specific).</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="excel">Working with Excel Files</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Excel format is very common in the business and finance world. DFLib supports reading DataFrames from and storing
them to Excel. You need to add an extra dependency to your project to take
advantage of this functionality:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>com.nhl.dflib<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>dflib-excel<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>TODO&#8230;&#8203;</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="avro">Working with .avro Files</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Avro binary file format is common in data engineering. Its main advantage is that files are saved with an embedded
schema. So when they are read back, the fields are converted to the correct original Java types. (This is different
from say CSV. Reading a <code>.csv</code> to a DataFrame by default only produces String columns). To save or load DataFrames
using the Avro format, include the following dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>com.nhl.dflib<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>dflib-avro<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Once you do that, <code>Avro</code> class is the entry point to all the operations. With it you can save DataFrames to <code>.avro</code>
files and load them back.</p>
</div>
<div class="sect2">
<h3 id="_avro_schema">Avro Schema</h3>
<div class="paragraph">
<p>In most cases you don&#8217;t need to know anything about Avro schemas. DFLib automatically generates a schema for a
DataFrame before it is saved. Alternatively you can create a custom <code>Schema</code> object based on
<a href="https://avro.apache.org/docs/current/spec.html">Avro specification</a> and pass it to <code>AvroSaver</code>.</p>
</div>
<div class="paragraph">
<p>TODO&#8230;&#8203;</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jupyter">Working in Jupyter Notebook</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While DFLib runs inside regular Java applications, it also works perfectly in a Jupyter notebook,
which is a very common environment among data scientists, and is usually associated with Python / pandas. Jupyter
Notebook is very visual and allows you to debug each step of your data load and transformation pipeline individually
without a need to rerun the whole thing.</p>
</div>
<div class="paragraph">
<p>Combining DFLib with Jupyter provides a pandas-like notebook experience, only in pure Java. The code developed in
notebook can be later copied and pasted into your application. Java developers should consider using Jupyter as a part
of their data project workflow, and DFLib design (and its Jupyter integration features described here) makes it rather
easy.</p>
</div>
<div class="sect2">
<h3 id="_installing_jupyter_with_java_kernel">Installing Jupyter with Java Kernel</h3>
<div class="ulist">
<ul>
<li>
<p>Install Jupyter. Follow Jupyter installation instructions. It requires Python. Out of the variety of installation
options, the authors of this document are using Mac OS, pyenv, Python 3.7, and pip.</p>
</li>
<li>
<p>Install <a href="https://github.com/SpencerPark/IJava">iJava Jupyter kernel</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_work_with_dflib_in_jupyter">Work with DFLib in Jupyter</h3>
<div class="paragraph">
<p>Start Jupyter</p>
</div>
<div class="listingblock">
<div class="content">
<pre>jupyter notebook</pre>
</div>
</div>
<div class="paragraph">
<p>The browser opens. Click on "New &gt; Java". In the document cell enter something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">%maven com.nhl.dflib:dflib-jupyter:<span class="float">0.18</span> <i class="conum" data-value="1"></i><b>(1)</b>

<span class="keyword">import</span> <span class="include">com.nhl.dflib.jupyter</span>.*;
<span class="keyword">import</span> <span class="include">com.nhl.dflib</span>.*;

DFLibJupyter.init(getKernelInstance());</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>It is enough to include <code>dflib-jupyter</code>. All other DFLib modules will be added through its transitive dependencies.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Click "Shift + Return" to execute the cell. If the are no errors, you can start using DFLib API in the following cells.
E.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DataFrame df = DataFrame.foldByColumn(<span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">b</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">c</span><span class="delimiter">&quot;</span></span>)
    .ofInts(-<span class="integer">1</span>, <span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">3</span>, <span class="integer">4</span>, <span class="integer">5</span>, <span class="integer">6</span>);

<span class="comment">// the result of the last statement in a cell is printed just below it</span>
df</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_change_display_parameters">Change Display Parameters</h3>
<div class="paragraph">
<p>To control truncation behavior, you can use static methods on <code>DFLibJupyter</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DFLibJupyter.setMaxDisplayRows(<span class="integer">10</span>);
DFLibJupyter.setMaxDisplayColumnWidth(<span class="integer">50</span>);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_notebooks_and_version_control">Notebooks and Version Control</h3>
<div class="paragraph">
<p>Jupyter places the data generated by the notebook in the notebook itself. This creates a challenge maintaining
notebooks under version control. Assuming you are using Git, you will need to add Git hooks to your project to strip
off the data before commit.</p>
</div>
<div class="paragraph">
<p>TODO: a recipe for excluding the data</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="unit-testing">Unit Testing</h2>
<div class="sectionbody">

</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2023-10-28 15:44:23 -0400
</div>
</div>
<link media="all" rel="stylesheet" href="css/style_v2.min.css" />
</body>
</html>